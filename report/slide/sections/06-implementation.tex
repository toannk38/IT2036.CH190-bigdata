% Implementation section
\section{Triển khai hệ thống}

\begin{frame}{Aggregation \& API Service}
    \begin{block}{Aggregation Service}
        \begin{itemize}
            \item Weighted scoring: Technical (40\%), Risk (30\%), Sentiment (30\%)
            \item Final score: 0-100 scale với configurable weights
            \item Alert thresholds: BUY (>70), WATCH (40-70), RISK (<40)
            \item MongoDB collection: \texttt{final\_scores}
        \end{itemize}
    \end{block}
    
    \begin{block}{REST API Service}
        \begin{itemize}
            \item FastAPI framework (port 8000)
            \item Endpoints: \texttt{/stocks}, \texttt{/analysis}, \texttt{/alerts}, \texttt{/health}
            \item JSON response với CORS support
            \item Error handling với structured logging
        \end{itemize}
    \end{block}
    
    \vspace{0.5em}
    \begin{center}
        \textit{[Placeholder for API Architecture Diagram]}
    \end{center>
\end{frame}

\begin{frame}{Airflow Orchestration}
    \begin{center}
        \textbf{[Placeholder for Airflow DAGs Diagram]}
        \vspace{1em}
    \end{center>
    
    \begin{block}{3 DAGs độc lập}
        \begin{enumerate}
            \item \textbf{price\_collection:} Chạy mỗi 5 phút (*/5 * * * *)
            \begin{itemize}
                \item PythonOperator: collect\_prices\_task
                \item Retries: 2, timeout: 10 minutes
            \end{itemize}
            
            \item \textbf{news\_collection:} Chạy mỗi 30 phút (*/30 * * * *)
            \begin{itemize}
                \item PythonOperator: collect\_news\_task
                \item Retries: 2, timeout: 15 minutes
            \end{itemize}
            
            \item \textbf{analysis\_pipeline:} Chạy mỗi giờ (@hourly)
            \begin{itemize}
                \item Parallel: run\_ai\_ml\_task + run\_llm\_task
                \item Sequential: aggregate\_results\_task
            \end{itemize}
        \end{enumerate}
    \end{block}
\end{frame>