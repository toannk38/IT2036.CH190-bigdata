version: '3.8'

# Development environment overrides
services:
  mongodb:
    ports:
      - "27017:27017"  # Expose for development access
    environment:
      MONGO_INITDB_ROOT_USERNAME: admin
      MONGO_INITDB_ROOT_PASSWORD: admin123
    volumes:
      - ./docker_volumes/mongodb:/data/db

  redis:
    ports:
      - "6379:6379"  # Expose for development access
    command: redis-server --requirepass redis123 --appendonly yes

  kafka:
    ports:
      - "9092:9092"
      - "9093:9093"
    environment:
      KAFKA_AUTO_CREATE_TOPICS_ENABLE: "true"
      KAFKA_DELETE_TOPIC_ENABLE: "true"

  kafka-ui:
    ports:
      - "8080:8080"

  nginx:
    ports:
      - "80:80"
    volumes:
      - ./configs/nginx/nginx.conf:/etc/nginx/nginx.conf:ro
      - ./configs/nginx/conf.d:/etc/nginx/conf.d:ro

  prometheus:
    ports:
      - "9090:9090"

  grafana:
    ports:
      - "3000:3000"
    environment:
      GF_SECURITY_ADMIN_USER: admin
      GF_SECURITY_ADMIN_PASSWORD: admin123

  elasticsearch:
    ports:
      - "9200:9200"
      - "9300:9300"
    environment:
      discovery.type: single-node
      ES_JAVA_OPTS: "-Xms512m -Xmx512m"  # Reduced for development
      xpack.security.enabled: "false"

  kibana:
    ports:
      - "5601:5601"

  logstash:
    ports:
      - "5044:5044"
      - "5000:5000"
      - "9600:9600"